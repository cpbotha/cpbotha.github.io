<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>openpgp on voices in my head</title><link>https://cpbotha.net/tags/openpgp/</link><description>Recent content in openpgp on voices in my head</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><managingEditor>cpbotha@cpbotha.net (Charl P. Botha)</managingEditor><webMaster>cpbotha@cpbotha.net (Charl P. Botha)</webMaster><lastBuildDate>Sun, 11 Dec 2016 15:34:26 +0000</lastBuildDate><atom:link href="https://cpbotha.net/tags/openpgp/index.xml" rel="self" type="application/rss+xml"/><item><title>PGP Never Gonna Give You Up</title><link>https://cpbotha.net/2016/12/11/pgp-never-gonna-give-you-up/</link><pubDate>Sun, 11 Dec 2016 15:34:26 +0000</pubDate><author>cpbotha@cpbotha.net (Charl P. Botha)</author><guid>https://cpbotha.net/2016/12/11/pgp-never-gonna-give-you-up/</guid><description> (Summary: Cryptographically signing messages with my long-term PGP keys is too important to give up. Doing this on my Android telephone is easier than I thought. You should strengthen your secret key encryption if you&amp;rsquo;re also going to do this.)
Recently, Filippo Valsorda, cryptography expert and TLS guy at Cloudflare, wrote that he was giving up on PGP, or at least on long term PGP keys.
I agree with many of his points, especially the complexity of managing those keys, lack of forward secrecy (if someone were to steal my keys, they could decrypt all past conversations, unlike for example Signal) and accessibility (how do you verify a message with a baby on your left arm and your telephone in your right?</description><content:encoded><![CDATA[ <p><em>(Summary: Cryptographically signing messages with my long-term PGP keys is
too important to give up. Doing this on my Android telephone is easier than I
thought. You should strengthen your secret key encryption if you&rsquo;re also
going to do this.)</em></p>
<p>Recently, Filippo Valsorda, cryptography expert and TLS guy at Cloudflare,
<a href="https://blog.filippo.io/giving-up-on-long-term-pgp/">wrote that he was giving up on PGP, or at least on long term PGP keys</a>.</p>
<p>I agree with many of his points, especially the complexity of managing those
keys, lack of forward secrecy (if someone were to steal my keys, they could
decrypt all past conversations, unlike for example Signal) and accessibility
(how do you verify a message with a baby on your left arm and your telephone
in your right?). More generally, it makes a great deal of sense to make your
security a moving target, <a href="https://twitter.com/FiloSottile/status/807612248223051776">as one of the Ars Technica commenters
astutely summarised Filippo&rsquo;s ideas</a>.</p>
<h2 id="cryptographic-signatures-ftw">Cryptographic signatures FTW</h2>
<p>However, in spite of these factors, I am not yet ready to give up my PGP long-term keys.</p>
<p>Why is that?</p>
<p><em>Well, one of the most important uses of my long-term PGP keys is to
cryptographically sign messages that can be verified by people in my network
as having come from my hands.</em></p>
<p>For example, when I change my phone or re-flash its firmware (this has
happened 3 or 4 times over the past two months because Android), I send
PGP-signed messages to my main Signal correspondents with our new safety
numbers.</p>
<p>With all of these correspondents I have in the past either done some sort of
in-person formal PGP signing procedure, or I make use of the web of trust, or
I rely on <a href="https://keybase.io/">keybase</a>. My business cards even
have my key fingerprint on them (yes, I&rsquo;m one of those nerds).</p>
<p>At their ends, the recipients of my messages are able to determine with an
extremely high degree of confidence that <em>I</em> wrote the exact message they
opened.</p>
<h2 id="accessible-pgp-on-your-smartphone-with-openkeychain">Accessible PGP on your smartphone with OpenKeychain</h2>
<p>In terms of accessibility, the post did make me curious enough to experiment
with a mobile PGP solution, as I also did have to agree that I&rsquo;ve in the
past often had to wait until I was behind one of my own laptops or
workstations to PGP-verify a message.</p>
<p>As my one friend explained on Signal:</p>
<p>It&rsquo;s tricky to verify a message with a baby in your left hand and a telephone in your right!</p>
<p><a href="https://www.openkeychain.org/">OpenKeychain</a> to the rescue!</p>
<h3 id="strengthen-your-secret-key-encryption">Strengthen your secret key encryption</h3>
<p>Seeing that I was planning on carrying my long-term private keys around on my
telephone (BlackBerry PRIV, FDE encryption active FWIW), I had to double-check
the security of the secret key encryption.</p>
<p>It turns out that PGP encrypts each of your secret keys with a hash of the
passphrase you supply. My passphrase is significantly longer than the average,
and consists of random characters (uppercase, lowercase, numbers,
symbols). Passphrase length and complexity is by far the most important factor
determining the safety of your encrypted secret key.</p>
<p>However, I had the default SHA-1 hash (ouch) with only 64k
iterations. Iterating the hash is called <a href="https://en.wikipedia.org/wiki/Key_stretching">key stretching</a>: the
passphrase is hashed, that result is hashed, and so on, for very many times,
so that the testing of each passphrase takes more time, complicating
brute-force cracking approaches.</p>
<p>Inspired by <a href="http://nullprogram.com/blog/2012/06/24/">the writings of
Chris Wellons</a> who keeps his encrypted secret keys on a public website
(!!!), I reconfigured my private key encryption to use 1 million iterations of
the SHA-512 hash, and to use AES-256 for the encryption itself:</p>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gpg --s2k-cipher-algo AES256 --s2k-digest-algo SHA512 --s2k-mode <span style="color:#2aa198;font-weight:bold">3</span> --s2k-count <span style="color:#2aa198;font-weight:bold">1000000</span> --edit-key 384435C7E77A4564
</span></span></code></pre></div><p>After typing that command, enter <code>passwd</code> at the prompt, then
follow the prompts. You will have to enter your passphrase, and then enter
your new passphrase twice.</p>
<p>You can then check that this operation is successful by using the command <code>gpg &ndash;list-packets secring.gpg</code>. My output looks as follows. Most important is that algo is 9 (AES-256), hash is 10 (SHA-512) and protect count in my case is just over 1 million.</p>
<pre><code>:secret key packet:
version 4, algo 1, created 1376407300, expires 0
skey[0]: [4096 bits]
skey[1]: [17 bits]
iter+salt S2K, algo: 9, SHA1 protection, hash: 10, salt: blabla
protect count: 1015808 (
protect IV:
encrypted stuff follows
keyid: 384435C7E77A4564
</code></pre>
<p>SHA-512 is the slowest hash which PGP offers (see <a href="http://thepasswordproject.com/oclhashcat_benchmarking">these oclHashcat
benchmarks for example</a>), which means that each iteration of a brute-force
password cracking attempt will take a bit longer / eat more GPU watts, which
is exactly what we want. You can increase the protect count for as long as the
delay on your smartphone is still tolerable.</p>
<p>However, remember that a stronger and longer passphrase is much better! (so we
do both)</p>
<p>Other than that, remember that <a href="/2016/11/27/android-security-in-2016-is-a-mess/">Android security is far
from good</a>, so do as much as you can to keep your phone safe (keep up with
OS updates, stay away from unofficial app markets, and so on).</p>
<h3 id="use-your-keys-with-openkeychain">Use your keys with OpenKeychain</h3>
<p>I was pleasantly surprised to learn that I could directly import both my
<code>secring.pgp</code> and <code>pubring.gpg</code> files from my
<code>~/.gnupg</code> directory. Right after selecting secring.pgp for import,
the UI looked like this:</p>








<figure><a href="/wp-content/uploads/2016/12/Screenshot_20161209-075007.png">
    <img
        
            
            src="/wp-content/uploads/2016/12/Screenshot_20161209-075007-576x1024.png"
        /> </a>
</figure>

<p>You can see the old 1024 bit key I made in 2000 to use for my Debian
activities, and the 4096 bit key I currently use.</p>
<p>After importing your secret and public keyring, you are able to encrypt,
decrypt, sign and verify any files or clipboard contents on your Android
phone:</p>








<figure><a href="/wp-content/uploads/2016/12/Screenshot_20161211-170851.png">
    <img
        
            
            src="/wp-content/uploads/2016/12/Screenshot_20161211-170851-576x1024.png"
        /> </a>
</figure>

<p>So if I receive something like this via Signal:</p>
<pre><code>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Never gonna give you up, never gonna let you down
Never gonna run around and desert you
Never gonna make you cry, never gonna say goodbye
Never gonna tell a lie and hurt you
-----BEGIN PGP SIGNATURE-----

iQFEBAEBCgAuJxxTdGVmYW4gdmFuIGRlciBXYWx0IDxzdGVmYW5Ac3VuLmFjLnph
PgUCWE2aUQAKCRDl/rykoDTdZZgvB/9Yi76C9o7xIgQ/d85WbnKDjNosp5uXzgHm
A2y+cxZDLVNLTMrlCTXOMRulaJMvb3Ocsvi+/gQVUF49fT74EXlZpZvvdTzhQfa2
VvQPjZmf/9PNzB3pgUtEDBwyLC21C6dqU+y7mPk91Aw1m8cKBQUSHmQxa7F/dCFc
DCuWOcXjNt5vLQ2Q8mQBMpHaG9J5+4/0k/GEHAVcm55fzb7o2hJyEVb3EoYy8Pls
khIwJpZVdwyY4FPoLXW3iJYanC5qoOoS81YLCyLEyin0jH56ve05uHbF0XcaNY4h
NupkN2D+Dt4X2m2FXieM27eG/Ty9hVx7n7B3pT4P9KqeFDX8hQ/q
=c7j9
-----END PGP SIGNATURE-----
</code></pre>
<p>I long-press, copy the message and then select “read from
clipboard” from OpenKeychain&rsquo;s Encrypt/Decrypt screen, which, if
everything checks out, shows me the following message:</p>








<figure><a href="/wp-content/uploads/2016/12/Screenshot_20161211-202817.png">
    <img
        
            
            src="/wp-content/uploads/2016/12/Screenshot_20161211-202817-576x1024.png"
        /> </a>
</figure>

<p>I can now rest assured that <a href="http://mentat.za.net/">this
specific buddy of mine</a> is never gonna give me up and is never gonna let me
down.</p>
<p>Cryptographically signing a message is equally easy, except that you&rsquo;ll
have to enter that long passphrase of yours. OpenKeychain will then make the
signed and optionally encrypted text text available for sharing to any app, or
for copying and pasting:</p>








<figure><a href="/wp-content/uploads/2016/12/Screenshot_20161211-174458.png">
    <img
        
            
            src="/wp-content/uploads/2016/12/Screenshot_20161211-174458-576x1024.png"
        /> </a>
</figure>

<p>Easy peasy, and tested under all sorts of usually-PGP-unfriendly conditions!</p>
<h2 id="conclusion">Conclusion</h2>
<p>Maintaining PGP long-term keys certainly has its issues, but the possibility
of cryptographically signing any message so that recipients can establish with
high confidence that it originated from you is too important to give up.</p>
<p>With an app like OpenKeychain and sufficiently strong passphrase hashing and
secret key encryption, you are able to use your keys with ease from your
telephone.</p>
<p>Granted, you are trading in some security for this convenience. However, given
the choice between discarding my PGP keys completely, vs. taking these steps,
I&rsquo;ll hold on to my keys for a little while longer.</p>
<p>In order to mitigate the potential damage of one of my long-term keys being
compromised, I have resolved to generate and start using a new private key as
soon as I run through my current batch of business cards, and to continue
rotating like this in the future.</p>
<p>Let me know in the comments what you think. Do you know of a better
alternative for remotely verifying the identity and messages of your
correspondents?</p>
]]></content:encoded></item></channel></rss>