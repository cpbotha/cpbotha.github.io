<!doctype html><html><head><title>Drop-in replacement for Hugo figure shortcode with responsive img srcset // voices in my head</title><meta charset=utf-8><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=author content="Charl P. Botha"><meta property="og:title" content="Drop-in replacement for Hugo figure shortcode with responsive img srcset"><meta property="og:description" content="When I moved this blog over to Hugo slightly more than a year ago, I started using Laura Kalbag&rsquo;s special img shortcode with img srcset support.
To make a long and interesting story short, srcset enables us to tell the browser that we have for example 5 different resolutions of an image available, and that it should choose the best one based on the user&rsquo;s device.
Pretty neat actually!
Anyways, I tweaked the code a bit over time, and most recently I combined it with the stock Hugo figure shortcode."><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://cpbotha.net/2020/05/02/drop-in-replacement-for-hugo-figure-shortcode-with-responsive-img-srcset/"><link rel="shortcut icon" href=/favicon.ico><link href=https://cpbotha.net/webfonts/ptserif/main.css rel=stylesheet type=text/css><link href=https://cpbotha.net/webfonts/source-code-pro/main.css rel=stylesheet type=text/css><style>@import 'https://fonts.googleapis.com/css2?family=Newsreader:ital,wght@0,400;0,700;1,400;1,700&family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap'</style><link rel=stylesheet href=https://cpbotha.net/css/style.css><meta name=generator content="Hugo 0.101.0"></head><body><div id=container><header id=header><div id=header-outer class=outer><div id=header-inner class=inner><a id=main-nav-toggle class=nav-icon href=javascript:;></a>
<a id=logo class=logo-text href=https://cpbotha.net/>voices in my head</a><nav id=main-nav><a class=main-nav-link href=/about/>About</a>
<a class=main-nav-link href=/links/>Links</a>
<a class=main-nav-link href=/archive/>Posts Archive</a>
<a class=main-nav-link href=/software/>Software</a>
<a class=main-nav-link href=/following-this-blog/>Following this blog</a></nav><nav id=sub-nav><div id=search-form-wrap></div></nav></div></div></header><section id=main class=outer><article class="article article-type-post" itemscope itemprop=blogPost><div class=article-inner><header class=article-header><h1 class=article-title itemprop=name>Drop-in replacement for Hugo figure shortcode with responsive img srcset</h1></header><div class=article-meta><a href=/2020/05/02/drop-in-replacement-for-hugo-figure-shortcode-with-responsive-img-srcset/ class=article-date><time datetime=2020-05-02T11:42:00.000+02:00 itemprop=datePublished>2020-05-02</time></a><div class=post-categories><div class=article-category><a class=article-category-link href=https://cpbotha.net//categories/howto>howto</a></div></div><div class=article-comment-link-wrap><a href=/2020/05/02/drop-in-replacement-for-hugo-figure-shortcode-with-responsive-img-srcset/#isso-thread class=article-comment-link>Comments</a></div></div><div class=article-entry itemprop=articleBody><p>When <a href=/2019/03/31/wordpress-to-hugo/#bonus-level-bundling-and-automatic-resizing-of-images>I moved this blog over to
Hugo</a>
slightly more than a year ago, I started using <a href=https://laurakalbag.com/processing-responsive-images-with-hugo/>Laura Kalbag&rsquo;s special <code>img</code>
shortcode</a>
with <a href=https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia%5Fand%5Fembedding/Responsive%5Fimages>img srcset
support</a>.</p><p>To make a long and interesting story short, <code>srcset</code> enables us to tell the
browser that we have for example 5 different resolutions of an image available,
and that it should choose the best one based on the user&rsquo;s device.</p><p>Pretty neat actually!</p><p>Anyways, I tweaked the code a bit over time, and most recently I combined it
with the stock Hugo <code>figure</code> shortcode.</p><p>What this means, is that you can now use just the straight <a href=https://gohugo.io/content-management/shortcodes/#figure>Hugo <code>figure</code>
shortcode as per the
documentation</a>, and my
modified shortcode will do all of image processing and srcset specification
fully automatically.</p><p>In other words, you only have to refer to your fullest resolution image in the
figure shortcode, and hugo will take care of creating a number of downscaled
versions, and offer them to modern browsers in a way that gives the user the
best experience.</p><h2 id=install-and-use>Install and use</h2><p>To install, simply download <a href=https://gist.github.com/cpbotha/deb310eed14308fe26f7b7d0fabeb34d>the figure.html
gist</a>
(embedded below) into the <code>layouts/shortcodes</code> directory in your hugo blog and
then rebuild your blog.</p><p><strong>NOTE:</strong> It&rsquo;s <strong>very</strong> important that images have to be in <a href=https://gohugo.io/content-management/page-bundles/>the page
bundle</a> if you want
automatic resizing and srcset. The shortcode will fall back to stock Hugo
behaviour otherwise.</p><script type=application/javascript src=https://gist.github.com/cpbotha/deb310eed14308fe26f7b7d0fabeb34d.js></script><h2 id=example-result>Example result</h2><p>I&rsquo;ve posted the image below so you can see the shortcode in action.</p><p>It started as <code>{{&lt; figure src="20200324_stillbaai_beach.jpg" link="20200324_stillbaai_beach.jpg" caption="..." >}}</code> and ended up as the
image below.</p><p>If you right click, and then inspect, you&rsquo;ll see the <code>srcset</code>
specification. Even better if you switch to the network panel in devtools, then
reload, and note that your browser downloads a lower resolution image if you&rsquo;ve
narrowed your viewport, or switched devtools to mobile emulation.</p><figure><a href=20200324_stillbaai_beach.jpg><img sizes="(min-width: 35em) 1200px, 100vw" srcset='https://cpbotha.net/2020/05/02/drop-in-replacement-for-hugo-figure-shortcode-with-responsive-img-srcset/20200324_stillbaai_beach_hu5cb26fe1d9f946c4e246a456961c0c88_490318_480x0_resize_q75_box.jpg 480w,
https://cpbotha.net/2020/05/02/drop-in-replacement-for-hugo-figure-shortcode-with-responsive-img-srcset/20200324_stillbaai_beach_hu5cb26fe1d9f946c4e246a456961c0c88_490318_800x0_resize_q75_box.jpg 800w,
https://cpbotha.net/2020/05/02/drop-in-replacement-for-hugo-figure-shortcode-with-responsive-img-srcset/20200324_stillbaai_beach_hu5cb26fe1d9f946c4e246a456961c0c88_490318_1200x0_resize_q75_box.jpg 1200w,
https://cpbotha.net/2020/05/02/drop-in-replacement-for-hugo-figure-shortcode-with-responsive-img-srcset/20200324_stillbaai_beach_hu5cb26fe1d9f946c4e246a456961c0c88_490318_1500x0_resize_q75_box.jpg 1500w,' src=https://cpbotha.net/2020/05/02/drop-in-replacement-for-hugo-figure-shortcode-with-responsive-img-srcset/20200324_stillbaai_beach_hu5cb26fe1d9f946c4e246a456961c0c88_490318_800x0_resize_q75_box.jpg alt="Figure 1: A photo taken on the beach in Stilbaai on March 24, 2020."></a><figcaption><p>Figure 1: A photo taken on the beach in Stilbaai on March 24, 2020.</p></figcaption></figure><h2 id=updates>Updates</h2><ul><li>On 2020-05-10 I updated the shortcode to fall back to stock Hugo behaviour
instead of just breaking when the image was not part of the page
bundle. However, if you want resizing and srcset (the whole point of this
post), your images should be in the page bundle. :)</li></ul></div><div class=article-toc><h3>Contents</h3><nav id=TableOfContents><ul><li><ul><li><a href=#install-and-use>Install and use</a></li><li><a href=#example-result>Example result</a></li><li><a href=#updates>Updates</a></li></ul></li></ul></nav></div><footer class=article-footer><ul class=article-tag-list><li class=article-tag-list-item><a class=article-tag-list-link href=https://cpbotha.net//tags/hugo>hugo</a></li><li class=article-tag-list-item><a class=article-tag-list-link href=https://cpbotha.net//tags/srcset>srcset</a></li><li class=article-tag-list-item><a class=article-tag-list-link href=https://cpbotha.net//tags/responsive>responsive</a></li></ul></footer></div><nav id=article-nav><a href=/2020/05/03/weekly-head-voices-193-covid-19-part-3/ id=article-nav-newer class=article-nav-link-wrap><div class=article-nav-title><span>&lt;</span>&nbsp;
Weekly Head Voices #193: COVID-19 part 3.</div></a><a href=/2020/04/13/weekly-head-voices-191-covid-19-part-2/ id=article-nav-older class=article-nav-link-wrap><div class=article-nav-title>Weekly Head Voices #192: COVID-19 part 2.&nbsp;<span>></span></div></a></nav><div class=article-footer>Related posts:
<a href=/2020/01/12/the-2019-to-2020-transition-post/>ðŸŒ¤ The 2019 to 2020 transition post.</a>
<a href=/2019/04/01/weekly-head-voices-167-yes-and/>ðŸŒ¤ Weekly Head Voices #167: Yes, and...</a>
<a href=/2019/03/31/wordpress-to-hugo/>ðŸŒ¤ Moving 18 years of this personal blog from Wordpress to Hugo</a></div></article><style>.isso-comment .avatar img{max-width:100%}.isso-comment>div.text-wrapper>div.text p{margin-top:1em}</style><script data-isso=/isso/cpbotha.net/ data-isso-reply-notifications=true data-isso-avatar=false data-isso-gravatar=true data-isso-max-comments-nested=inf data-isso-max-comments-top=inf data-isso-require-email=true data-isso-vote=false src=/isso/cpbotha.net/js/embed.min.js></script><section data-title="Drop-in replacement for Hugo figure shortcode with responsive img srcset" id=isso-thread></section></section><footer id=footer><div id=search-form-wrap><form class=search-form method=get action=https://duckduckgo.com/><input type=search name=q class=search-text placeholder title size=20 maxlength=128>
<input type=hidden name=sites value=cpbotha.net>
<input type=submit value="Search site with DDG" class=hidden></form></div><div class=outer><div id=footer-info class=inner>&copy; 2022 Charl P. Botha<br>Powered by <a href=https://gohugo.io target=_blank>Hugo</a> with theme <a href=https://github.com/carsonip/hugo-theme-minos target=_blank>Minos</a></div></div><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/solarized-light.min.css integrity=sha384-bFKDPkG3geCujYJIbPornilfOgmYQoPS45Oh/8daqqo1SUwNY06OeHorpgnNvx82 crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin=anonymous></script>
<script>hljs.initHighlightingOnLoad()</script><script>document.getElementById("main-nav-toggle").addEventListener("click",function(){var e=document.getElementById("header");e.classList.contains("mobile-on")?e.classList.remove("mobile-on"):e.classList.add("mobile-on")})</script></footer></div></body></html>